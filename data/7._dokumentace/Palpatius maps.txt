# ğŸ—ºï¸ TechnickÃ¡ mapa systÃ©mu Palpatius
Tento dokument je mentÃ¡lnÃ­ mapa systÃ©mu urÄenÃ¡ vÃ½hradnÄ› autorovi.

## ÄŒÃ¡st 1: KaskÃ¡dovÃ© styly (assets/css)

Styly jsou do systÃ©mu naÄÃ­tÃ¡ny v tomto poÅ™adÃ­: `tailwind.css` â†’ `fonts.css` â†’ `core.css` â†’ `main.css` â†’ `[modulovÃ½].css`.

### 1. tailwind.css (ZÃ¡kladnÃ­ stavebnÃ­ kÃ¡men)

* **ÃšÄel:** ExternÃ­ knihovna (framework), kterÃ¡ poskytuje CSS reset (Preflight) a utility tÅ™Ã­dy pro layout a design.
* **DÅ¯leÅ¾itÃ©:** Tento soubor se **nikdy neupravuje ruÄnÄ›**. Pokud je v designu chyba, opravuje se buÄ v HTML (zmÄ›nou tÅ™Ã­dy), nebo v `core.css`.
* **Obsah:** SjednocenÃ­ chovÃ¡nÃ­ prohlÃ­Å¾eÄÅ¯, definice CSS promÄ›nnÃ½ch a tisÃ­ce pomocnÃ½ch tÅ™Ã­d (`flex`, `p-4` atd.).

### 2. fonts.css (FontovÃ¡ infrastruktura)

* **ÃšÄel:** LokÃ¡lnÃ­ definice pÃ­sma **Inter**.
* **Filozofie:** Offline-first (Å¾Ã¡dnÃ© stahovÃ¡nÃ­ z Google Fonts), ochrana soukromÃ­ a vysokÃ½ vÃ½kon dÃ­ky dÄ›lenÃ­ na jazykovÃ© sady (`unicode-range`).
* **Funkce:** ZajiÅ¡Å¥uje, Å¾e se pÃ­smo zobrazÃ­ okamÅ¾itÄ› (pomocÃ­ `font-display: swap`) a stahujÃ­ se jen ty znaky, kterÃ© uÅ¾ivatel potÅ™ebuje (napÅ™. latinka).

### 3. core.css (VizuÃ¡lnÃ­ pÃ¡teÅ™)

* **ÃšÄel:** Definice globÃ¡lnÃ­ho vzhledu, typografie a pÅ™Ã­stupnosti (A11y).
* **KlÃ­ÄovÃ© prvky:**
* **TmavÃ½ reÅ¾im:** ÄŒernÃ© pozadÃ­, bÃ­lÃ½ text (Inter) pro snÃ­Å¾enÃ­ Ãºnavy oÄÃ­.
* **Kontejner:** Sjednocuje Å¡Ã­Å™ku aplikace a vytvÃ¡Å™Ã­ vizuÃ¡lnÃ­ "karty" (`#111`).
* **Typografie:** VÃ½raznÃ¡ Å¾lutÃ¡ barva (`#facc15`) pro nadpisy, jasnÃ¡ hierarchie pro ÄteÄky obrazovky.
* **Interakce:** RozbalovacÃ­ sekce (`details/summary`) a vÃ½raznÃ© stavy fokusu u tlaÄÃ­tek.
* **Stavy:** StandardizovanÃ© ikony pro ÃºspÄ›ch (zelenÃ¡) a chybu (ÄervenÃ¡).

### 4. main.css (SjednocujÃ­cÃ­ mezivrstva)

* **ÃšÄel:** "Main Connector", kterÃ½ ladÃ­ detaily a zajiÅ¡Å¥uje, aby Tailwind nepÅ™epsal dÅ¯leÅ¾itÃ¡ rozhodnutÃ­ Palpatia.
* **Funkce:** ZapÃ­nÃ¡ vyhlazovÃ¡nÃ­ pÃ­sma (font-smoothing), sjednocuje chovÃ¡nÃ­ odkazÅ¯ (dÄ›dÃ­ barvu, podtrÅ¾enÃ­ pÅ™i hoveru) a potvrzuje tmavÃ© pozadÃ­.

## ÄŒÃ¡st 2: JavaScriptovÃ© utility (assets/js)

### 1. ui.js (RozhranÃ­ a pÅ™Ã­stupnost)

* **ÃšÄel:** SprÃ¡va modÃ¡lnÃ­ch oken, fokusu a klÃ¡vesovÃ© navigace.
* **KlÃ­ÄovÃ© funkce:**
* **showCustomModal:** BezpeÄnÃ© zobrazenÃ­ dialogu. UklÃ¡dÃ¡ si, kde byl uÅ¾ivatel pÅ™ed otevÅ™enÃ­m, aby ho tam po zavÅ™enÃ­ vrÃ¡til.
* **manageFocusTrap:** NepustÃ­ fokus z modÃ¡lnÃ­ho okna pryÄ (uÅ¾ivatel se "neztratÃ­" tabulÃ¡torem v pozadÃ­).
* **closeCustomModal:** KompletnÃ­ Ãºklid â€“ zavÅ™e okno, odstranÃ­ event listenery (prevence memory leakÅ¯) a vrÃ¡tÃ­ fokus.

* **Filozofie:** Å½Ã¡dnÃ© globÃ¡lnÃ­ promÄ›nnÃ©, vÅ¡e je uzavÅ™enÃ© a bezpeÄnÃ©.

### 2. utils.js (DatovÃ¡ bezpeÄnostnÃ­ sÃ­Å¥)

* **ÃšÄel:** ÄŒistÃ¡ datovÃ¡ vrstva pro formÃ¡tovÃ¡nÃ­ a validaci.
* **ZÃ¡sadnÃ­ pravidlo:** **Å½Ã¡dnÃ© tichÃ© selhÃ¡nÃ­.** Pokud funkce dostane Å¡patnÃ¡ data, vrÃ¡tÃ­ `null` a loguje chybu. Nikdy neposÃ­lÃ¡ dÃ¡l odhadnutÃ© nesmysly.
* **KlÃ­ÄovÃ© funkce:**
* **formatDateForInput / parseDateFromInput:** BezpeÄnÃ½ most pro pÅ™evod dat mezi uÅ¾ivatelskÃ½m rozhranÃ­m a databÃ¡zÃ­.
* **getYearMonth / getYear:** RychlÃ¡ extrakce Äasu pro filtry a statistiky.
* **calculateExpiryDate:** NejsloÅ¾itÄ›jÅ¡Ã­ funkce â€“ Å™eÅ¡Ã­ pÅ™estupnÃ© roky, neexistujÃ­cÃ­ dny a validuje skuteÄnou existenci data.

## ğŸ’¡ RychlÃ¡ nÃ¡povÄ›da pro ÃºdrÅ¾bu
| Pokud je problÃ©m v... | ...dÃ­vej se do: |
| **PÃ­smu** (neÄitelnÃ©, chybÃ­ znaky) | `fonts.css` |
| **ZÃ¡kladnÃ­ch barvÃ¡ch** (nadpisy, pozadÃ­) | `core.css` |
| **Odkazech a hoverech** | `main.css` |
| **VÃ½poÄtech a datech** (chybnÃ¡ expirace) | `utils.js` |
| **ModÃ¡lnÃ­ch oknech** (nejdou zavÅ™Ã­t, blbne Tab) | `ui.js` |
| **Layoutu** (odsazenÃ­, flexbox) | HTML (Tailwind tÅ™Ã­dy) |

# TechnickÃ¡ mapa modulu: MasÃ©rna

## ÄŒÃ¡st 1: index.html (Struktura rozhranÃ­)

### 1.1 ZÃ¡klad dokumentu a hlaviÄka
* **ÃšÄel:** Definice dokumentu, metadat a import stylÅ¯.
* **ZaÄÃ¡tek:** `<!DOCTYPE html>` (Å™Ã¡dek 1)
* **Konec:** `<link rel="stylesheet" href="style.css">` (Å™Ã¡dek 15)

### 1.2 HlavnÃ­ navigace modulÅ¯
* **ÃšÄel:** PÅ™epÃ­nÃ¡nÃ­ mezi moduly systÃ©mu Palpatius.
* **ZaÄÃ¡tek:** `<nav class="module-nav" aria-label="HlavnÃ­ navigace">` (Å™Ã¡dek 17)
* **Konec:** `</nav>` (Å™Ã¡dek 29)

### 1.3 HlavnÃ­ kontejner a hlaviÄka modulu
* **ÃšÄel:** Obal obsahu modulu, nÃ¡zev a systÃ©movÃ© notifikace.
* **ZaÄÃ¡tek:** `<div class="container">` (Å™Ã¡dek 31)
* **Konec:** `<div id="backupReminder" class="hidden"></div>` (Å™Ã¡dek 35)

### 1.4 HornÃ­ akÄnÃ­ liÅ¡ta
* **ÃšÄel:** Export, import dat a vyvolÃ¡nÃ­ nÃ¡povÄ›dy.
* **ZaÄÃ¡tek:** `<div class="flex items-center justify-between mb-6">` (Å™Ã¡dek 37)
* **Konec:** `</div>` (Å™Ã¡dek 55)

### 1.5 OvlÃ¡dacÃ­ prvky formulÃ¡Å™Å¯
* **ÃšÄel:** PÅ™epÃ­naÄe pro zobrazenÃ­ pÄ›ti hlavnÃ­ch formulÃ¡Å™ovÃ½ch sekcÃ­.
* **ZaÄÃ¡tek:** `<div class="flex flex-wrap justify-center mb-6">` (Å™Ã¡dek 57)
* **Konec:** `</div>` (Å™Ã¡dek 63)

### 1.6 FormulÃ¡Å™ovÃ© sekce (ID a rozsahy)
1. **PÅ™idat klienta:** `<div id="clientFormSection" ...>` (Å™Ã¡dek 65â€“75)
2. **PÅ™idat masÃ¡Å¾:** `<div id="massageFormSection" ...>` (Å™Ã¡dek 77â€“104)
3. **NÃ¡kup poukazÅ¯:** `<div id="voucherPurchaseFormSection" ...>` (Å™Ã¡dek 106â€“123)
4. **PoloÅ¾ka cenÃ­ku:** `<div id="priceListFormSection" ...>` (Å™Ã¡dek 125â€“146)
5. **PoznÃ¡mka ke klientovi:** `<div id="clientNoteFormSection" ...>` (Å™Ã¡dek 148â€“164)

### 1.7 DatovÃ© tabulky a filtrace
* **GlobÃ¡lnÃ­ filtr:** `<div class="filter-section">` (Å™Ã¡dek 166â€“171)
* **SprÃ¡va klientÅ¯:** `<section aria-labelledby="clients-heading">` (Å™Ã¡dek 173â€“207)
* **CenÃ­k masÃ¡Å¾Ã­:** `<section aria-labelledby="pricelist-heading">` (Å™Ã¡dek 209â€“241)
* **Historie masÃ¡Å¾Ã­:** `<section aria-labelledby="massage-history-heading">` (Å™Ã¡dek 243â€“277)
* **SprÃ¡va poukazÅ¯:** `<section aria-labelledby="vouchers-heading">` (Å™Ã¡dek 279â€“310)

### 1.8 ModÃ¡lnÃ­ okna a skripty
* **ModÃ¡lnÃ­ okna:** `<div id="customMessageModal" ...>` (Å™Ã¡dek 312â€“426)
* **Import skriptÅ¯:** `<script src="../../assets/js/utils.js"></script>` (Å™Ã¡dek 428â€“434)

## ÄŒÃ¡st 2: script.js (AplikaÄnÃ­ logika)

### 2.1 GlobÃ¡lnÃ­ stav a databÃ¡ze
* **Stav:** Definice `zaznamnikDataForClient` a konstanty `DB_NAME`.
* **IndexedDB:** Funkce `openDatabase()`, `loadDataFromDB()`, `saveDataToDB()` a `autoSave()`.
* **Rozsah:** ZaÄÃ­nÃ¡ komentÃ¡Å™em v hlaviÄce, konÄÃ­ "// --- Konec kÃ³du pro prÃ¡ci s IndexDB ---".

### 2.2 Integrace a externÃ­ komunikace
* **Finance:** Funkce `sendFinanceEntry` a `sendFinancialTransaction`.
* **ZÃ¡znamnÃ­k:** Funkce `loadZaznamnikRecordsForClient(clientId)`.

### 2.3 UI Logika a navigace
* **NÃ¡povÄ›da:** Funkce `openHelpModal()` a `closeHelpModal()`.
* **FormulÃ¡Å™e:** Logika `toggleForm` a `activeFormId`.
* **Tabulky:** Funkce `toggleTableSection` a univerzÃ¡lnÃ­ tÅ™Ã­dÄ›nÃ­ `sortStates`.
* **Autocomplete:** Funkce `setupAutocomplete` a `resetAutocomplete`.

### 2.4 CRUD Operace (Data)
* **Klienti:** Funkce `addClient()` aÅ¾ `deleteClient(id)`.
* **MasÃ¡Å¾e:** Funkce `addMassage()` aÅ¾ `deleteClientMassage()`.
* **CenÃ­k:** Funkce `addPriceListItem()` aÅ¾ `submitCountToPriceListItem()`.
* **Poukazy:** Funkce `addVoucherPurchase()` aÅ¾ `submitEditIndividualVoucher()`.
* **PoznÃ¡mky:** Funkce `addClientNote()` aÅ¾ `deleteClientNote()`.

### 2.5 VÄ›rnostnÃ­ program a statusy
* **Status:** `updateClientStatus()` a `submitEditClientStatus()`.
* **Loyalty:** `addLoyaltyPoint(clientId)` a `removeLoyaltyPoint(clientId)`.

### 2.6 RenderovÃ¡nÃ­ a systÃ©movÃ© funkce

* **ZobrazenÃ­:** HlavnÃ­ renderovacÃ­ funkce `displayClients()` aÅ¾ `toggleVoucherPurchaseDetails()`.
* **MazÃ¡nÃ­:** CentrÃ¡lnÃ­ funkce `confirmAndDeleteItem()`.
* **Export/Import:** Funkce `exportItemToTxt()` a kompletnÃ­ `exportAllMasernaData()`.

### 2.7 Inicializace (Bootstrap)
* **Listenery:** `initEventListeners()`.
* **Start:** `document.addEventListener('DOMContentLoaded', ...)` (Å™Ã¡dek 428â€“434).

## ÄŒÃ¡st 3: style.css (VizuÃ¡lnÃ­ styly)

### 3.1 ZÃ¡klady a typografie
* **Rozsah:** ZaÄÃ­nÃ¡ u `body`, konÄÃ­ definicÃ­ `h3`.
* **Obsah:** Kontrast, zÃ¡kladnÃ­ barvy a hierarchie nadpisÅ¯.

### 3.2 TlaÄÃ­tka a formulÃ¡Å™e
* **TlaÄÃ­tka:** Definice `button` a jeho stavÅ¯ (hover, focus).
* **FormulÃ¡Å™e:** Styly pro `.form-section`, inputy a tÅ™Ã­du `.hidden`.

### 3.3 Komponenty UI
* **Autocomplete:** Kontejnery a poloÅ¾ky naÅ¡eptÃ¡vaÄe.
* **Tabulky:** ZÃ¡kladnÃ­ styly `table`, hover efekty a `.table-responsive`.
* **Statusy:** BarevnÃ© odliÅ¡enÃ­ statusÅ¯ klientÅ¯ (very_active, inactive).

### 3.4 SpecifickÃ© sekce modulu
* **Detail klienta:** `.client-detail-section` a vnoÅ™enÃ© prvky.
* **ZÃ¡lohovÃ¡nÃ­:** `.backup-reminder` a tooltipy.
* **ModÃ¡ly:** Styly pro `.modal` a `.modal-buttons`.
* **VÄ›rnost:** `.loyalty-section` a zvÃ½raznÄ›nÃ­ bonusÅ¯.

### 3.5 Navigace a A11y
* **PÅ™Ã­stupnost:** TÅ™Ã­da `.sr-only`.
* **ModulovÃ¡ navigace:** Definice hornÃ­ liÅ¡ty a responzivnÃ­ chovÃ¡nÃ­ pro mobilnÃ­ zaÅ™Ã­zenÃ­.

TechnickÃ¡ mapa modulu: FinanÄnÃ­ sprÃ¡vce

## ÄŒÃ¡st 1: index.html (Struktura rozhranÃ­)

### 1.1 ZÃ¡klad dokumentu a importy
* **ÃšÄel:** Definice dokumentu, metadat a naÄtenÃ­ sdÃ­lenÃ½ch i modulovÃ½ch stylÅ¯.
* **ZaÄÃ¡tek:** `<!DOCTYPE html>` (Å™Ã¡dek 1)
* **Konec:** `<link rel="stylesheet" href="style.css">` (Å™Ã¡dek cca 15)
* **PoznÃ¡mka:** PouÅ¾Ã­vÃ¡ kompletnÃ­ CSS kaskÃ¡du Palpatius (`tailwind â†’ fonts â†’ core â†’ main â†’ modul`).

### 1.2 HlavnÃ­ navigace modulÅ¯
* **ÃšÄel:** PÅ™epÃ­nÃ¡nÃ­ mezi moduly systÃ©mu Palpatius.
* **ZaÄÃ¡tek:** `<nav class="module-nav" aria-label="HlavnÃ­ navigace">`
* **Konec:** `</nav>`
* **Funkce:** AktivnÃ­ modul je zvÃ½raznÄ›n pomocÃ­ JS (na zÃ¡kladÄ› URL).

### 1.3 HlavnÃ­ kontejner a nÃ¡zev modulu
* **ÃšÄel:** Obal veÅ¡kerÃ©ho obsahu modulu a jeho identifikace.
* **ZaÄÃ¡tek:** `<div class="container">`
* **Konec:** pÅ™ed importem skriptÅ¯
* **Nadpis:** `<h1>FinanÄnÃ­ sprÃ¡vce</h1>`

### 1.4 GlobÃ¡lnÃ­ akÄnÃ­ liÅ¡ta
* **ÃšÄel:** Export/import dat a vyvolÃ¡nÃ­ nÃ¡povÄ›dy.
* **ZaÄÃ¡tek:** `<div class="flex items-center justify-between mb-6" id="globalControls">`
* **Konec:** `</div>`
* **Prvky:**
  * Export vÅ¡ech dat (JSON)
  * Import vÅ¡ech dat (JSON)
  * TlaÄÃ­tko nÃ¡povÄ›dy

### 1.5 OvlÃ¡dacÃ­ tlaÄÃ­tka formulÃ¡Å™Å¯
* **ÃšÄel:** PÅ™epÃ­nÃ¡nÃ­ hlavnÃ­ch vstupnÃ­ch formulÃ¡Å™Å¯.
* **ZaÄÃ¡tek:** `<div class="flex flex-wrap justify-center mb-6" id="addButtonsSection">`
* **Konec:** `</div>`
* **TlaÄÃ­tka:**

  * PÅ™idat transakci
  * PÅ™idat poloÅ¾ku skladu

### 1.6 FormulÃ¡Å™ovÃ© sekce
1. **PÅ™idat transakci**
   `<div id="transactionFormSection" class="form-section hidden">`
2. **PÅ™idat poloÅ¾ku skladu**
   `<div id="stockItemFormSection" class="form-section hidden">`

### 1.7 GlobÃ¡lnÃ­ filtr
* **ÃšÄel:** FiltrovÃ¡nÃ­ napÅ™Ã­Ä transakcemi a skladem.
* **ZaÄÃ¡tek:** `<div class="filter-section">`
* **Konec:** `</div>`
* **Prvky:** input + tlaÄÃ­tko â€ZruÅ¡it filtrâ€œ

### 1.8 DatovÃ© tabulky a pÅ™ehledy
1. **PÅ™ehled transakcÃ­**
   `<section aria-labelledby="transactions-heading">`
2. **MÄ›sÃ­ÄnÃ­ pÅ™ehledy**
   `<section aria-labelledby="monthly-summary-heading">`
3. **RoÄnÃ­ pÅ™ehledy**
   `<section aria-labelledby="annual-summary-heading">`
4. **PÅ™ehled skladu**
   `<section aria-labelledby="stock-heading">`
KaÅ¾dÃ¡ sekce obsahuje:
* tlaÄÃ­tko Zobrazit / Sbalit
* `.table-responsive`
* `<table>` s tÅ™Ã­dÄ›nÃ­m pomocÃ­ `data-sort`

### 1.9 ModÃ¡lnÃ­ okna
* **SystÃ©movÃ¡ zprÃ¡va:** `#customMessageModal`
* **Ãšprava mnoÅ¾stvÃ­ skladu:** `#adjustStockQuantityModal`
* **NÃ¡povÄ›da:** `#helpModal`

### 1.10 Import skriptÅ¯
* `../../assets/js/utils.js`
* `../../assets/js/ui.js`
* `script.js` (modulovÃ¡ logika)

## ÄŒÃ¡st 2: script.js (AplikaÄnÃ­ logika)

### 2.1 GlobÃ¡lnÃ­ stav
* **financialData**
  * `transactions`
  * `annualMassages`
  * `stockItems`
* **sortStates** â€“ univerzÃ¡lnÃ­ stav tÅ™Ã­dÄ›nÃ­ tabulek

### 2.2 IndexedDB vrstva
* **DatabÃ¡ze:** `palpatiusFinancialDB`
* **Object store:** `financialData`
* **Funkce:**
  * `openDatabase()`
  * `loadDataFromDB()`
  * `saveDataToDB()`
  * `autoSave()`
* **Rozsah:** oznaÄen komentÃ¡Å™i
  `// --- ZaÄÃ¡tek kÃ³du pro prÃ¡ci s IndexDB ---`
  `// --- Konec kÃ³du pro prÃ¡ci s IndexDB ---`

### 2.3 UI a navigace
* **NÃ¡povÄ›da:** `openHelpModal()`, `closeHelpModal()`
* **FormulÃ¡Å™e:** `toggleForm()`, `activeFormId`
* **Sekce tabulek:** `toggleTableSection()`

### 2.4 Transakce (ÃºÄetnictvÃ­)
* **CRUD:**

  * `addTransaction()`
  * `editTransaction()`
  * `submitEditTransaction()`
  * `deleteTransaction()`
* **ZobrazenÃ­:** `displayTransactions()`

### 2.5 PÅ™ehledy
* **MÄ›sÃ­ÄnÃ­:** `displayMonthlySummaries()`
* **RoÄnÃ­:** `displayAnnualSummaries()`
* **PoÄet masÃ¡Å¾Ã­:**
  * `editAnnualMassages()`
  * `submitEditAnnualMassages()`

### 2.6 Sklad
* **CRUD:**
  * `addItemToStock()`
  * `editStockItem()`
  * `submitEditStockItem()`
  * `deleteStockItem()`
* **MnoÅ¾stvÃ­:**
  * `adjustStockQuantity()`
  * `submitAdjustQuantity()`
* **ZobrazenÃ­:** `displayStockItems()`
* **Stav skladu:** zvÃ½raznÄ›nÃ­ `.low-stock`

### 2.7 SpoleÄnÃ© systÃ©movÃ© funkce
* **MazÃ¡nÃ­:** `confirmAndDeleteItem()`
* **TÅ™Ã­dÄ›nÃ­:** `sortTable()`
* **Aktualizace UI:** `updateTables()`
* **Filtr:** `clearFilter()`

### 2.8 Export / Import
* **JSON:**
  * `exportAllData()`
  * `importAllData()` (vÄetnÄ› migrace a validace)
* **TXT export poloÅ¾ek:** `exportItemToTxt()`

### 2.9 Inicializace (Bootstrap)
* **Listenery:** `initEventListeners()`
* **Start aplikace:** `DOMContentLoaded`
  * otevÅ™enÃ­ DB
  * naÄtenÃ­ dat
  * navÃ¡zÃ¡nÃ­ tÅ™Ã­dÄ›nÃ­
  * prvnÃ­ render

### 2.10 AktivnÃ­ zvÃ½raznÄ›nÃ­ modulu
* **IIFE blok**
* Detekce modulu podle URL
* NastavenÃ­ `.active` + `aria-current="page"`

## ÄŒÃ¡st 3: style.css (VizuÃ¡lnÃ­ styly)

### 3.1 ZÃ¡kladnÃ­ vzhled
* `body`, `.container`
* TmavÃ½ reÅ¾im, vysokÃ½ kontrast

### 3.2 Typografie
* `h1`, `h2`
* Nadpisy s akÄnÃ­mi tlaÄÃ­tky (Zobrazit / Sbalit)

### 3.3 TlaÄÃ­tka
* `.btn-primary`, `.btn-secondary`, `.btn-danger`
* `.btn-export`, `.btn-import`, `.btn-toggle-form`
* FokusovÃ© stavy (A11y)

### 3.4 FormulÃ¡Å™e
* `.form-section`
* inputy, selecty, textarea
* `.hidden`

### 3.5 Tabulky
* ZÃ¡kladnÃ­ styl tabulek
* Å˜azenÃ­ (`sorted-asc`, `sorted-desc`)
* Hover, sudÃ©/lichÃ© Å™Ã¡dky
* `.table-responsive`

### 3.6 ModÃ¡lnÃ­ okna
* `.modal`, `.modal-content`, `.modal-buttons`
* SpeciÃ¡lnÃ­ Ãºpravy pro formulÃ¡Å™e v modÃ¡lu

### 3.7 Stav skladu
* `.low-stock` â€“ vizuÃ¡lnÃ­ upozornÄ›nÃ­

### 3.8 Navigace modulÅ¯
* `.module-nav`
* AktivnÃ­ modul (`.active`)
* ResponzivnÃ­ chovÃ¡nÃ­

TechnickÃ¡ mapa modulu: ZÃ¡znamnÃ­k

## ÄŒÃ¡st 1: index.html (Struktura rozhranÃ­)

### 1.1 ZÃ¡klad dokumentu a importy
* **ÃšÄel:** Definice dokumentu, jazyka, metadat a naÄtenÃ­ CSS kaskÃ¡dy Palpatius.
* **ZaÄÃ¡tek:** `<!DOCTYPE html>` (Å™Ã¡dek 1)
* **Konec:** `<link rel="stylesheet" href="style.css">`
* **PoÅ™adÃ­ stylÅ¯:**
  `tailwind.css â†’ fonts.css â†’ core.css â†’ main.css â†’ zaznamnik/style.css`

### 1.2 HlavnÃ­ kontejner a navigace modulÅ¯
* **ÃšÄel:** Obal celÃ©ho modulu + globÃ¡lnÃ­ navigace.
* **Kontejner:** `<div class="container">`
* **Navigace:**
  `<nav class="module-nav" aria-label="HlavnÃ­ navigace">`
* **PoloÅ¾ky:** MasÃ©rna, Finance, ZÃ¡znamnÃ­k, Knihovna, Finance Extra
* **AktivnÃ­ modul:** Å™eÅ¡en JS (aria-current + `.active`)

### 1.3 HlaviÄka modulu
* **Nadpis:** `<h1 id="mainTitle">CentrÃ¡lnÃ­ zÃ¡znamnÃ­k</h1>`
* **ÃšÄel:** Identifikace modulu, orientaÄnÃ­ bod pro ÄteÄky.

### 1.4 GlobÃ¡lnÃ­ akÄnÃ­ liÅ¡ta
* **ÃšÄel:** PrÃ¡ce s daty a nÃ¡povÄ›da.
* **ZaÄÃ¡tek:** `<div class="flex items-center justify-between mb-6" id="globalControls">`
* **Obsah:**
  * Export vÅ¡ech dat (JSON)
  * Import vÅ¡ech dat (JSON, `<input type="file">`)
  * TlaÄÃ­tko nÃ¡povÄ›dy
* **Konec:** `</div>`

### 1.5 PÅ™epÃ­naÄe formulÃ¡Å™Å¯
* **ÃšÄel:** PÅ™epÃ­nÃ¡nÃ­ hlavnÃ­ch typÅ¯ zÃ¡znamÅ¯.
* **ZaÄÃ¡tek:** `<div class="flex flex-wrap justify-center mb-6" id="addButtonsSection">`
* **TlaÄÃ­tka:**
  * PÅ™idat poznÃ¡mku
  * PÅ™idat To-Do List
  * PÅ™idat udÃ¡lost
  * PÅ™idat nÃ¡pad
* **Vazba:** `aria-controls`, `aria-expanded`
* **Konec:** `</div>`

### 1.6 FormulÃ¡Å™ovÃ© sekce
KaÅ¾dÃ¡ sekce mÃ¡ tÅ™Ã­du `.form-section hidden`.
1. **PoznÃ¡mka**
   `<div id="noteFormSection">`
2. **To-Do List (vytvoÅ™enÃ­ seznamu)**
   `<div id="todoListFormSection">`
3. **To-Do Ãºkol (poloÅ¾ka seznamu)**
   `<div id="todoFormSection">`
4. **UdÃ¡lost**
   `<div id="eventFormSection">`
5. **NÃ¡pad**
   `<div id="ideaFormSection">`

### 1.7 Filtrace a pÅ™epÃ­naÄe typu
* **TextovÃ½ filtr:**
  `<div class="filter-section">`
* **TypovÃ© filtry:**
  TlaÄÃ­tka `.btn-toggle-filter` (all, note, todo_list, event, idea)
* **ÃšÄel:** ZÃºÅ¾enÃ­ dat v hlavnÃ­ tabulce

### 1.8 HlavnÃ­ tabulka dat
* **ID:** `#mainDataTable`
* **Sloupce:**
  * Typ
  * Klient
  * NÃ¡zev / Popis
  * Detail / TermÃ­n
  * Kategorie / Priorita
  * Akce
* **Å˜azenÃ­:** `th[data-sort]`

### 1.9 ModÃ¡lnÃ­ okna
1. **UniverzÃ¡lnÃ­ systÃ©movÃ½ modal**
   * `#customMessageModal`
   * PotvrzenÃ­, chyby, zobrazenÃ­ detailÅ¯
2. **Akce po pÅ™idÃ¡nÃ­ nÃ¡padu**
   * `#ideaActionsModal`
   * PÅ™idÃ¡nÃ­ do MasÃ©rny / To-Do
3. **Detail To-Do listu**
   * `#todoListDetailSection`
   * SamostatnÃ¡ tabulka ÃºkolÅ¯
4. **NÃ¡povÄ›da**
   * `#helpModal`

### 1.10 Import skriptÅ¯
* `../../assets/js/utils.js`
* `../../assets/js/ui.js`
* `script.js` (logika modulu)

## ÄŒÃ¡st 2: script.js (AplikaÄnÃ­ logika)

### 2.1 GlobÃ¡lnÃ­ stav
* **HlavnÃ­ datovÃ¡ struktura:**
  data = { notes, todos, events, ideas }
* **ExternÃ­ data:**
  `masernaClients`
* **UI stav:**
  `currentFilter`, `currentView`, `currentTodoListId`, `sortStates`

### 2.2 IndexedDB â€“ ZÃ¡znamnÃ­k
* **DB:** `PalpatiusZaznamnikDB`
* **Store:** `zaznamnikData`
* **Funkce:**
  * `openDatabase()`
  * `loadDataFromDB()`
  * `saveDataToDB()`
  * `autoSave()`
* **Rozsah:**
  `// --- ZaÄÃ¡tek kÃ³du pro prÃ¡ci s IndexDB ---`
  `// --- Konec kÃ³du pro prÃ¡ci s IndexDB ---`

### 2.3 Integrace s MasÃ©rnou
* **DB:** `palpatiusMasernaDB`
* **NaÄtenÃ­ klientÅ¯:** `loadClientsFromMasernaDB()`
* **PomocnÃ© funkce:**
  * `populateClientSelects()`
  * `getClientNameById()`
  * `getClientOptionsHTML()`

### 2.4 UI a navigace
* **FormulÃ¡Å™e:** `toggleForm()`, `activeFormId`
* **NÃ¡povÄ›da:** `openHelpModal()`, `closeHelpModal()`
* **PÅ™epÃ­nÃ¡nÃ­ pohledÅ¯:**
  hlavnÃ­ tabulka â†” detail To-Do listu

### 2.5 PoznÃ¡mky (CRUD)
* `addNote()`
* `viewNote()`
* `editNote()`
* `submitEditNote()`

### 2.6 To-Do Listy a Ãºkoly
* **Listy:**
  * `addTodoList()`
  * `editTodoListName()`
  * `submitEditTodoListName()`
* **Ãškoly:**
  * `addTask()`
  * `toggleTaskCompletionInList()`
  * `editTaskInList()`
  * `submitEditTaskInList()`
  * `deleteTaskInList()`
* **Detail listu:**
  `showTodoListDetails()`, `goBackToMainView()`
* **Render:** `updateTasksTable()`

### 2.7 UdÃ¡losti (CRUD)
* `addEvent()`
* `viewEvent()`
* `editEvent()`
* `submitEditEvent()`

### 2.8 NÃ¡pady (CRUD + akce)
* `addIdea()`
* `viewIdea()`
* `editIdea()`
* `submitEditIdea()`
* **Akce:**
  * `showIdeaActionsModal()`
  * `sendToMasernaPricelist()`
  * `convertIdeaToTodo()`

### 2.9 SpoleÄnÃ© funkce
* **MazÃ¡nÃ­:** `confirmAndDeleteItem()`, `doDeleteItem()`
* **Å˜azenÃ­:** `sortTable()`
* **Filtrace:** `filterByType()`, `clearFilter()`
* **Render hlavnÃ­ tabulky:** `updateTable()`
* **Export:** `exportItemToTxt()`, `exportAllData()`
* **Import:** `importAllData()`

### 2.10 Inicializace
* `DOMContentLoaded`
  * otevÅ™enÃ­ DB
  * naÄtenÃ­ klientÅ¯
  * naÄtenÃ­ dat
  * navÃ¡zÃ¡nÃ­ Å™azenÃ­
  * inicializace filtrÅ¯
* **AktivnÃ­ modul:** IIFE blok podle URL

## ÄŒÃ¡st 3: style.css (VizuÃ¡lnÃ­ styly)

### 3.1 ZÃ¡kladnÃ­ layout
* `body`, `.container`
* TmavÃ½ reÅ¾im, vysokÃ½ kontrast

### 3.2 Typografie
* `h1`, `h2`
* BarevnÃ¡ hierarchie (Å¾lutÃ¡ = primÃ¡rnÃ­)

### 3.3 TlaÄÃ­tka
* `.btn-primary`, `.btn-secondary`, `.btn-danger`
* `.btn-export`, `.btn-import`, `.btn-toggle-form`
* FokusovÃ© stavy (A11y)

### 3.4 FormulÃ¡Å™e
* `.form-section`
* inputy, textarea, selecty
* `.hidden`

### 3.5 Tabulky
* `table`, `th`, `td`
* Å˜azenÃ­ (`sorted-asc`, `sorted-desc`)
* Hover a zebra Å™Ã¡dky

### 3.6 ModÃ¡ly
* `.modal`, `.modal-content`, `.modal-buttons`
* PÅ™ekryv, fokus, kontrast

### 3.7 StavovÃ© a typovÃ© styly
* Typy poloÅ¾ek (`.item-type-*`)
* To-Do:
  * `.todo-completed`
  * `.todo-priority-*`

### 3.8 Navigace modulÅ¯
* `.module-nav`
* AktivnÃ­ modul (`.active`)
* ResponzivnÃ­ chovÃ¡nÃ­

TechnickÃ¡ mapa modulu: **Knihovna**

## ÄŒÃST 1: `index.html` â€“ Struktura rozhranÃ­

### 1.1 ZÃ¡klad dokumentu a CSS kaskÃ¡da
* **ÃšÄel:** Inicializace HTML dokumentu + globÃ¡lnÃ­ vizuÃ¡lnÃ­ systÃ©m Palpatius
* **ZaÄÃ¡tek:** `<!DOCTYPE html>`
* **Konec:** `<link rel="stylesheet" href="style.css">`
* **PoÅ™adÃ­ stylÅ¯:**
  1. `tailwind.css`
  2. `fonts.css`
  3. `core.css`
  4. `main.css`
  5. `knihovna/style.css`

### 1.2 HlavnÃ­ kontejner a navigace modulÅ¯
* **Obal:** `<div class="container">`
* **Navigace:** `<nav class="module-nav" aria-label="HlavnÃ­ navigace">`
* **PoloÅ¾ky modulÅ¯:**
  * MasÃ©rna
  * Finance
  * ZÃ¡znamnÃ­k
  * **Knihovna**
  * FinanÄnÃ­ sprÃ¡vce Extra
* **AktivnÃ­ modul:** Å™eÅ¡en JS podle URL (`.active`, `aria-current="page"`)

### 1.3 HlaviÄka modulu
* **ID:** `#mainTitle`
* **Text:** â€Knihovna â€“ SprÃ¡va a evidence dokumentÅ¯, ÄlÃ¡nkÅ¯ a textÅ¯â€œ
* **Role:** jednoznaÄnÃ¡ identifikace modulu + orientaÄnÃ­ bod

### 1.4 GlobÃ¡lnÃ­ ovlÃ¡dacÃ­ liÅ¡ta
* **ID:** `#globalControls`
* **Obsah:**
  * Export vÅ¡ech dat (JSON)
  * Import vÅ¡ech dat (JSON, `<input type="file">`)
  * TlaÄÃ­tko nÃ¡povÄ›dy
* **Charakter:** globÃ¡lnÃ­ operace nad celou knihovnou

### 1.5 Sekce pÅ™idÃ¡nÃ­ obsahu
* **ID:** `#addButtonsSection`
* **TlaÄÃ­tko:**
  * â€PÅ™idat textâ€œ
* **NapojenÃ­:** `onclick="showArticleForm(null)"`

### 1.6 FormulÃ¡Å™ pro text (add / edit)
* **ID:** `#articleFormSection`
* **TÅ™Ã­dy:** `.form-section.hidden`
* **ReÅ¾imy:**
  * PÅ™idÃ¡nÃ­ novÃ©ho textu
  * Editace existujÃ­cÃ­ho textu
* **Pole:**
  * `#articleTitle` â€“ nÃ¡zev
  * `#articleCategory` â€“ kategorie (fixnÃ­ seznam)
  * `#articleContent` â€“ ÄistÃ½ text
* **TlaÄÃ­tka:**
  * UloÅ¾it / UloÅ¾it zmÄ›ny
  * ZruÅ¡it (zavÅ™enÃ­ formulÃ¡Å™e)

### 1.7 Filtrace
* **Fulltext filtr:**
  * `#globalFilterInput`
* **TlaÄÃ­tko:**
  * ZruÅ¡it filtr
* **Kategorie:**
  * Dynamicky generovanÃ¡ tlaÄÃ­tka
  * Kontejner: `#categoryFilterButtons`

### 1.8 HlavnÃ­ tabulka knihovny
* **ID:** `#mainDataTable`
* **Sloupce:**
  1. NÃ¡zev (klik â†’ detail)
  2. Kategorie
  3. Akce
* **Å˜azenÃ­:** `th[data-sort]`

### 1.9 ModÃ¡lnÃ­ okna
1. **UniverzÃ¡lnÃ­ systÃ©movÃ½ modal**
   * `#customMessageModal`
   * PotvrzenÃ­, chyby, detail textu
2. **NÃ¡povÄ›da**
   * `#helpModal`
   * StatickÃ½ vysvÄ›tlujÃ­cÃ­ obsah

### 1.10 Import skriptÅ¯
* `../../assets/js/utils.js`
* `../../assets/js/ui.js`
* `script.js` (logika knihovny)

## ÄŒÃST 2: `script.js` â€“ Logika aplikace

### 2.1 GlobÃ¡lnÃ­ data a konstanty
* **Data:**
  let articles = [];
* **FixnÃ­ kategorie:**
  const FIXED_CATEGORIES = ['ÄŒlÃ¡nky', 'Dokumenty', 'Texty', 'OstatnÃ­'];
* **StavovÃ© promÄ›nnÃ©:**
  * `currentFilterCategory`
  * `sortStates`
  * `activeFormId`
  * `currentEditingId`

### 2.2 IndexedDB â€“ Knihovna
* **DB:** `PalpatiusKnihovnaDB`
* **Store:** `knihovnaData`
* **KlÃ­Ä:** `id = 'currentData'`
* **Rozsah kÃ³du:**

  * `// --- ZaÄÃ¡tek kÃ³du pro prÃ¡ci s IndexDB ---`
  * `// --- Konec kÃ³du pro prÃ¡ci s IndexDB ---`
* **Funkce:**
  * `openDatabase()`
  * `loadDataFromDB()`
  * `saveDataToDB()`
  * `autoSave()`

### 2.3 PÅ™epÃ­nÃ¡nÃ­ formulÃ¡Å™e
* **Funkce:** `toggleForm(formId)`
* **Logika:**
  * zavÅ™e ostatnÃ­ formulÃ¡Å™e
  * pÅ™epÃ­nÃ¡ `aria-expanded`
  * scroll + fokus

### 2.4 PÅ™idÃ¡nÃ­ / editace textu
* **OtevÅ™enÃ­ formulÃ¡Å™e:** `showArticleForm(id)`
* **OdeslÃ¡nÃ­ formulÃ¡Å™e:** `handleSubmitArticle()`
* **ChovÃ¡nÃ­:**
  * `id === null` â†’ novÃ½ text
  * `id !== null` â†’ editace
* **ID generace:** `Date.now()`

### 2.5 ZobrazenÃ­ obsahu textu
* **Funkce:** `viewArticle(id)`
* **ZobrazenÃ­:**
  * `<pre>` uvnitÅ™ modÃ¡lnÃ­ho okna
  * zachovÃ¡nÃ­ zalomenÃ­ Å™Ã¡dkÅ¯
  * pouze ÄtenÃ­

### 2.6 MazÃ¡nÃ­ poloÅ¾ky
* **PotvrzenÃ­:** `confirmAndDeleteItem(id)`
* **VlastnÃ­ smazÃ¡nÃ­:** `doDeleteItem(id)`
* **Dopad:**
  * odebrÃ¡nÃ­ z pole `articles`
  * uloÅ¾enÃ­ + redraw

### 2.7 Å˜azenÃ­ tabulky
* **Funkce:** `sortTable(tableId, sortKey)`
* **Stav:** `sortStates`
* **SmÄ›ry:** `asc / desc`

### 2.8 Aktualizace tabulky
* **Funkce:** `updateTable()`
* **Kroky:**
  1. Fulltext filtr
  2. Filtr kategorie
  3. Å˜azenÃ­
  4. Render Å™Ã¡dkÅ¯
  5. Aktualizace tlaÄÃ­tek kategoriÃ­

### 2.9 Filtrace kategoriÃ­
* **TlaÄÃ­tka:** generovanÃ¡ z `FIXED_CATEGORIES`
* **Funkce:**
  * `updateCategoryButtons()`
  * `filterByCategory(category)`
  * `clearFilter()`

### 2.10 Export / Import
* **Export TXT (jedna poloÅ¾ka):**
  * `exportItemToTxt(id)`
* **Export JSON (vÅ¡e):**
  * `exportAllData()`
* **Import JSON:**
  * `importAllData(event)`
  * validace pole
  * normalizace dat

### 2.11 NÃ¡povÄ›da
* `openHelpModal()`
* `closeHelpModal()`

### 2.12 Inicializace
* `DOMContentLoaded`
  * otevÅ™enÃ­ DB
  * naÄtenÃ­ dat
  * inicializace Å™azenÃ­
  * nastavenÃ­ modÃ¡lu
  * prvnÃ­ render
* **AktivnÃ­ modul:** IIFE blok podle URL

## ÄŒÃST 3: `style.css` â€“ VizuÃ¡lnÃ­ a pÅ™Ã­stupnostnÃ­ styly

### 3.1 ZÃ¡klad layoutu
* `body`, `.container`
* tmavÃ½ reÅ¾im, vysokÃ½ kontrast

### 3.2 Typografie
* `h1`, `h2`
* Å¾lutÃ¡ jako primÃ¡rnÃ­ zvÃ½raznÄ›nÃ­

### 3.3 TlaÄÃ­tka
* `.btn-primary`, `.btn-secondary`, `.btn-danger`
* `.btn-export`, `.btn-import`, `.btn-toggle-form`
* fokusovÃ© stavy (A11y)

### 3.4 FormulÃ¡Å™e
* `.form-section`
* inputy, textarea, select
* `.hidden`

### 3.5 Tabulka
* zebra Å™Ã¡dky
* hover
* tÅ™Ã­dÄ›nÃ­ (`sorted-asc`, `sorted-desc`)

### 3.6 ModÃ¡lnÃ­ okna
* `.modal`, `.modal-content`, `.modal-buttons`
* pÅ™ekryv + fokus

### 3.7 FiltraÄnÃ­ tlaÄÃ­tka kategoriÃ­
* `.btn-toggle-filter`
* aktivnÃ­ stav (`bg-blue-600`)

### 3.8 Navigace modulÅ¯
* `.module-nav`
* aktivnÃ­ poloÅ¾ka `.active`
* responzivnÃ­ chovÃ¡nÃ­

TechnickÃ¡ mapa modulu: **FinanÄnÃ­ sprÃ¡vce Extra**

## ÄŒÃST 1: `index.html` â€“ Struktura rozhranÃ­

### 1.1 ZÃ¡klad dokumentu
* **DOCTYPE:** HTML5
* **Jazyk:** `lang="cs"`
* **Meta:**
  * charset UTF-8
  * viewport responsive
* **CSS:**
  * pouze **lokÃ¡lnÃ­ `style.css`**
  * Å¾Ã¡dnÃ© globÃ¡lnÃ­ Palpatius CSS (sandbox reÅ¾im)

### 1.2 Navigace modulÅ¯
* **Element:** `<nav class="module-nav">`
* **Obsah:** odkazy na:
  * MasÃ©rna
  * Finance
  * ZÃ¡znamnÃ­k
  * Knihovna
  * **FinanÄnÃ­ sprÃ¡vce Extra**
* **AktivnÃ­ modul:** zvÃ½raznÄ›nÃ­ pÅ™es JS podle URL

### 1.3 HlavnÃ­ layout
* **Wrapper:** `.main-wrapper`
* **Karta:** `.main-card`
* **Obsah:** `<main>`

### 1.4 HlaviÄka modulu
* `<h1>`: â€FinanÄnÃ­ sprÃ¡vce Extraâ€œ
* **Popis modulu:** `.intro-text`
  * vysvÄ›tlenÃ­ ÃºÄelu
  * prÃ¡ce s kanÃ¡ly a poplatky

### 1.5 Sekce: Export / Import (nekolabovatelnÃ¡)
* **Class:** `.section-block`
* **TlaÄÃ­tka:**
  * `#export-json` â€“ export JSON
  * `#export-db` â€“ export celÃ© DB
  * `#import-json` â€“ import JSON

### 1.6 Sekce: PlatebnÃ­ kanÃ¡ly (collapsible)
* **Class:** `.section-block.collapsible`
* **Header:**
  * nÃ¡zev sekce
  * `.collapse-toggle`
* **Obsah:**
  * tlaÄÃ­tko `#add-channel`
  * tabulka kanÃ¡lÅ¯
  * formulÃ¡Å™ `#channel-form` (hidden)
#### Tabulka kanÃ¡lÅ¯
* Sloupce:
  * NÃ¡zev
  * Procento
  * FixnÃ­ poplatek
  * PoznÃ¡mka
  * Akce
#### FormulÃ¡Å™ kanÃ¡lu
* Pole:
  * `#channel-name`
  * `#channel-percent`
  * `#channel-fixed`
  * `#channel-note`
* ReÅ¾imy:
  * pÅ™idÃ¡nÃ­
  * editace (uloÅ¾eno v `dataset.editing`)

### 1.7 Sekce: Transakce (collapsible)
* **OvlÃ¡dÃ¡nÃ­:**
  * `#load-transactions`
  * filtr stavu `#filter-status`
* **Tabulka:**
  * Datum
  * Popis
  * Brutto
  * KanÃ¡l
  * ÄŒistÃ©
  * Akce (PÅ™iÅ™adit)

### 1.8 Sekce: Souhrny (collapsible)
* **Filtry:**
  * `#summary-from`
  * `#summary-to`
  * `#summary-channel`
* **VÃ½stupy:**
  * `#sum-brutto`
  * `#sum-fees`
  * `#sum-netto`
* **DetailnÃ­ tabulka:**
  * kanÃ¡l
  * poÄet
  * brutto
  * poplatky
  * netto

### 1.9 ModÃ¡lnÃ­ panel
* **ID:** `#assign-channel-panel`
* **Obsah:** `#assign-channel-list`
* **ÃšÄel:** pÅ™iÅ™azenÃ­ platebnÃ­ho kanÃ¡lu k transakci

### 1.10 Skript
* **JedinÃ½ JS:** `script.js`
* **Bez externÃ­ch zÃ¡vislostÃ­**

## ÄŒÃST 2: `script.js` â€“ Logika aplikace

## 2.1 ReÅ¾im modulu
* **KomentÃ¡Å™:** `SANDBOX VERSION`
* **Charakteristika:**
  * Å¾Ã¡dnÃ© globÃ¡lnÃ­ Palpatius utility
  * vlastnÃ­ IndexedDB
  * pÅ™Ã­mÃ½ pÅ™Ã­stup k hlavnÃ­ FS DB

## 2.2 IndexedDB â€“ FS Extra
* **DB:** `fs_extra`
* **Version:** `1`
* **Object Stores:**
  * `channels`
    * `id` (autoIncrement)
    * index: `name`
  * `transactions`
    * `id` (autoIncrement)
    * index: `idFS`
    * index: `status`
### Inicializace
* `initFsExtraDB()`

## 2.3 PlatebnÃ­ kanÃ¡ly
* **GlobÃ¡lnÃ­ pole:** `channels`
* **Funkce:**
  * `saveChannelToDB`
  * `updateChannelInDB`
  * `loadChannelsFromDB`
  * `renderChannels`
  * `openEditChannelForm`
* **Editace:**
  * index v poli `channels`
  * uloÅ¾en v `dataset.editing`

## 2.4 Transakce â€“ synchronizace
### Zdroj dat
* **DB:** `palpatiusFinancialDB`
* **Store:** `financialData`
* **KlÃ­Ä:** `currentData`
* **PouÅ¾itÃ¡ verze:** `2`
### ImportovanÃ© transakce
* pouze `type === 'income'`
* mapovÃ¡nÃ­:
  * `idFS`
  * `date`
  * `desc`
  * `brutto`
  * `channelId`
  * `netto`
  * `status`
### Funkce:
* `loadFsTransactions`
* `syncTransactionsToFsExtra`
* `loadTransactionsFromDb`

## 2.5 FiltrovÃ¡nÃ­ transakcÃ­
* **Filtr:** `#filter-status`
* **Stavy:**
  * `pending`
  * `completed`
* **Funkce:**
  * `filterAndRenderTransactions`
  * `renderTransactions`

## 2.6 PÅ™iÅ™azenÃ­ kanÃ¡lu
* **SpouÅ¡tÄ›Ä:** `.assign-channel`
* **Dialog:**
  * generovanÃ½ dynamicky
  * seznam kanÃ¡lÅ¯
* **VÃ½poÄet:**
  netto = brutto - (brutto * percent / 100) - fixed
* **UloÅ¾enÃ­:**
  * `channelId`
  * `netto`
  * `status: "completed"`
### Funkce:
* `openAssignChannelDialog`
* `assignChannelToTransaction`

## 2.7 Souhrny
### Filtrace:
* datum od / do
* kanÃ¡l
* pouze `completed`
### VÃ½poÄty:
* celkovÃ©:
  * brutto
  * poplatky
  * netto
* per-kanÃ¡l:
  * poÄet
  * brutto
  * fees
  * netto
### Funkce:
* `fillChannelSelect`
* `calculateSummary`

## 2.8 Export / Import
### Export:
* JSON (`exportDatabaseAsJson`)
* â€celÃ¡ databÃ¡zeâ€œ
* helper: `getAllFromStore`
### Import:
* pÅ™epsÃ¡nÃ­ celÃ© DB
* `overwriteDatabase`
* reload kanÃ¡lÅ¯ i transakcÃ­

## 2.9 Collapsible sekce
* **TÅ™Ã­da:** `.collapsible`
* **Mechanismus:**
  * `max-height`
  * `.open`
  * pÅ™epÃ­nÃ¡nÃ­ textu tlaÄÃ­tka

## 2.10 AktivnÃ­ modul v navigaci
* IIFE
* porovnÃ¡nÃ­ URL s mapou modulÅ¯
* pÅ™idÃ¡nÃ­ `.active`

## ÄŒÃST 3: `style.css` â€“ VizuÃ¡lnÃ­ vrstva

### 3.1 TÃ©ma
* **Dark mode**
* **ZlatÃ¡ (`#ffc43d`) jako akcent**
* **ÄŒernÃ© pozadÃ­, karty**

### 3.2 Layout
* `.main-wrapper`
* `.main-card`

### 3.3 Typografie
* `h1`, `h2`
* `.intro-text`

### 3.4 OvlÃ¡dacÃ­ prvky
* `.btn-primary`
* `.btn-secondary`
* `.btn-outline`
* `.input`, `.small-input`

### 3.5 Tabulky
* `.table`
* kontrastnÃ­ hlaviÄka
* oddÄ›lenÃ© buÅˆky

### 3.6 Karty a souhrny
* `.card`
* `.summary-box`

### 3.7 ModÃ¡l
* `.modal`
* `.modal-box`
* `.hidden`

### 3.8 NavigaÄnÃ­ liÅ¡ta
* identickÃ¡ struktura jako ostatnÃ­ moduly
* responzivnÃ­ chovÃ¡nÃ­

TechnickÃ¡ mapa modulu: **Palpatius Data Manager**

## ÄŒÃST 1: `index.html` â€“ Struktura rozhranÃ­

### 1.1 ZÃ¡klad dokumentu
* **DOCTYPE:** HTML5 (`<!doctype html>`)
* **Jazyk:** `lang="cs"`
* **Meta:**
  * charset UTF-8
  * viewport responsive
  * description (offline nÃ¡stroj, pouze ke ÄtenÃ­)
* **Styly:**
  * jedinÃ½ lokÃ¡lnÃ­ soubor `style.css`
* **Skripty:**
  * jedinÃ½ lokÃ¡lnÃ­ `script.js`

### 1.2 PÅ™Ã­stupnost â€“ skip link
* `<a class="skip-link" href="#main">`
* UmoÅ¾Åˆuje pÅ™eskoÄenÃ­ hlaviÄky
* CÃ­l: `<main id="main" tabindex="-1">`

### 1.3 HlaviÄka aplikace
* `<header class="app-header">`
* **Obsah:**
  * `<h1 class="app-title">`
  * `<p class="app-subtitle" id="appHint">`
* **ÃšÄel:**
  * nÃ¡zev nÃ¡stroje
  * vysvÄ›tlenÃ­, Å¾e jde o:
    * offline
    * pouze ke ÄtenÃ­
    * bez zÃ¡sahu do dat

### 1.4 HlavnÃ­ obsah (`<main>`)
* **ID:** `main`
* **Role:** hlavnÃ­ aplikaÄnÃ­ prostor
* **Sekce:** dvÄ› hlavnÃ­ karty

## 1.5 Sekce: NaÄtenÃ­ souboru
* `<section class="card" aria-labelledby="uploadTitle">`
### FormulÃ¡Å™ `#dmForm`
* **Atributy:** `novalidate`
* **Pole:**
  1. **JSON soubor**
     * `#jsonFile`
     * `accept="application/json,.json"`
     * `required`
  2. **VÃ½bÄ›r modulu**
     * `#moduleSelect`
     * moÅ¾nosti:
       * MasÃ©rna
       * FinanÄnÃ­ sprÃ¡vce
       * ZÃ¡znamnÃ­k
       * Knihovna
       * FinanÄnÃ­ sprÃ¡vce Extra
### AkÄnÃ­ tlaÄÃ­tka
* `#analyzeBtn` â€“ Vyhodnotit
* `#resetBtn` â€“ Reset
* `#exportTxtBtn` â€“ Export TXT (disabled default)
### StavovÃ½ Å™Ã¡dek
* `#formStatus`
* `role="status"`
* `aria-live="polite"`

## 1.6 Sekce: VÃ½sledek
* `<section class="card" aria-labelledby="resultTitle">`
### VÃ½sledkovÃ½ blok
* `<dl class="result-list" id="resultList">`
* **PrÃ¡zdnÃ½ stav:**
  * `#resultEmpty`
  * zobrazen pÅ™i nevyhodnocenÃ½ch datech

### 1.7 TechnickÃ© detaily (rozbalovacÃ­)
* `<details id="rawDetails">`
* `<summary>`: â€Zobrazit technickÃ© informaceâ€œ
#### Metadata
* `#metaModule`
* `#metaFileName`
* `#metaFileSize`
* `#metaLoadState`
#### Raw JSON vÃ½stup
* `<textarea id="rawOutput" readonly>`
* slouÅ¾Ã­ pouze ke kontrole

### 1.8 PatiÄka
* `<footer class="app-footer">`
* text:
  * offline nÃ¡stroj
  * pouze ke ÄtenÃ­
  * lokÃ¡lnÃ­ prÃ¡ce se soubory

## ÄŒÃST 2: `script.js` â€“ AplikaÄnÃ­ logika

## 2.1 Stav aplikace
* `loadedJson` â€“ naÄtenÃ½ JSON objekt
* `currentReportText` â€“ textovÃ½ report pro export

## 2.2 Reference na DOM
* VÅ¡echny dÅ¯leÅ¾itÃ© prvky naÄteny **hned na zaÄÃ¡tku**
* Å½Ã¡dnÃ© dynamickÃ© query selektory v logice

## 2.3 PomocnÃ© funkce
* `setStatus(text, isError)`
* `clearResults()`
* `addResultRow(label, value)`
* `formatDate()`

## 2.4 NaÄtenÃ­ souboru
* Listener na `#jsonFile`
* PouÅ¾itÃ­ `FileReader`
* **ChovÃ¡nÃ­:**
  * validace JSON
  * raw vÃ½pis do textarea
  * aktualizace metadat
  * Å¾Ã¡dnÃ© uklÃ¡dÃ¡nÃ­, Å¾Ã¡dnÃ© Ãºpravy

## 2.5 VyhodnocenÃ­ dat
* SpouÅ¡tÄ›Ä: `#analyzeBtn`
* Kontroly:
  * zda je JSON naÄten
  * zda je vybrÃ¡n modul
* VÃ½stup:
  * volÃ¡nÃ­ `buildReport(module, data)`
  * naplnÄ›nÃ­ vÃ½sledkovÃ© sekce
  * povolenÃ­ exportu TXT

## 2.6 ModulovÄ› specifickÃ¡ logika (`buildReport`)
* PÅ™epÃ­naÄ `switch(module)`
### MasÃ©rna
* `clients`
* `globalMassageHistory`
* `voucherPurchases`
* `notes`
* `priceListItems`

### FinanÄnÃ­ sprÃ¡vce
* `transactions`
* `monthlySummaries`
* `annualSummaries`
* `stockItems`

### ZÃ¡znamnÃ­k
* `notes`
* `todos`
* vnoÅ™enÃ© `tasks`
* `events`
* `ideas`

### Knihovna
* oÄekÃ¡vÃ¡ **pole**
* poÄÃ­tÃ¡ poÄet zÃ¡znamÅ¯

### FinanÄnÃ­ sprÃ¡vce Extra
* `transactions`
* poÄet celkem
* poÄet s `channelId`

## 2.7 Validace struktury
* Funkce `assert(condition, message)`
* Vyhazuje **Error**
* ZpracovÃ¡no v `try/catch`

## 2.8 Export do TXT
* GenerovÃ¡nÃ­ `Blob`
* StaÅ¾enÃ­ souboru:
  * `palpatius_data_report.txt`
* Exportuje **pouze report**, ne raw data

## 2.9 Reset aplikace
* VymazÃ¡nÃ­:

  * inputÅ¯
  * metadat
  * vÃ½sledkÅ¯
  * raw vÃ½pisu
* Stav: â€ResetovÃ¡no.â€œ

## ÄŒÃST 3: `style.css` â€“ VizuÃ¡lnÃ­ a A11y vrstva

### 3.1 DesignovÃ½ charakter
* KlidnÃ½, nÃ¡strojovÃ½, analytickÃ½
* Bez brandovÃ½ch barev Palpatia
* JasnÃ© oddÄ›lenÃ­:
  * vstup
  * vÃ½stup
  * technickÃ¡ data

### 3.2 CSS promÄ›nnÃ©
* barvy pozadÃ­
* texty
* akcent
* nebezpeÄÃ­ (`--danger`)
* border

### 3.3 Typografie
* System font stack
* JasnÃ¡ hierarchie `h1â€“h3`
* DÅ¯raz na Äitelnost

### 3.4 FormulÃ¡Å™e a vstupy
* KonzistentnÃ­ inputy
* ZvÃ½raznÄ›nÃ½ fokus (`:focus-visible`)
* Readonly textarea pro raw data

### 3.5 VÃ½sledky
* `.result-list`
* `.result-row` (grid)
* prÃ¡zdnÃ½ stav `.result-empty`

### 3.6 PÅ™Ã­stupnost
* Skip link
* `aria-live`
* `role="status"`
* `aria-labelledby`
* `:focus-visible`

### 3.7 Responsivita
* Breakpoint `600px`
* PÅ™epnutÃ­ layoutu vÃ½sledkÅ¯ na 1 sloupec
* MenÅ¡Ã­ paddingy

TechnickÃ¡ mapa: **HlavnÃ­ uvÃ­tacÃ­ strÃ¡nka Palpatius**

## ÄŒÃST 1: `index.html` â€“ Struktura vstupnÃ­ strÃ¡nky

### 1.1 ZÃ¡klad dokumentu
* **DOCTYPE:** HTML5
* **Jazyk:** `lang="cs"`
* **Meta:**
  * UTF-8
  * viewport (responsive)
* **Title:** `Palpatius â€“ Vstup do systÃ©mu`
* **Favicon:**
  * `assets/icons/favicon.ico`
* **Styly:**
  * jeden lokÃ¡lnÃ­ soubor `style.css`
* **Skript:**
 * jeden lokÃ¡lnÃ­ soubor `script.js`

### 1.2 HlavnÃ­ obsah (`<main>`)
* **TÅ™Ã­da:** `welcome-container`
* **Role:** jedinÃ½ aplikaÄnÃ­ kontejner strÃ¡nky
* **Charakter:** statickÃ¡ vstupnÃ­ obrazovka (landing)

### 1.3 NÃ¡zev systÃ©mu
* `<h1 class="title">PALPATIUS</h1>`
* SlouÅ¾Ã­ jako:
  * vizuÃ¡lnÃ­ identita
  * jasnÃ½ vstupnÃ­ bod
* Bez interakce

### 1.4 Podtitul
* `<p class="subtitle">JednoduchÃ½ systÃ©m pro masÃ©ry</p>`
* StruÄnÃ© vysvÄ›tlenÃ­ ÃºÄelu systÃ©mu

### 1.5 Vstup do aplikace
* `<a class="enter-button">`
* **CÃ­l:**
  `data/1._maserna/index.html`
* **ARIA:**
  * `aria-label="Vstoupit do systÃ©mu Palpatius"`
* **Role:**
  * jedinÃ½ akÄnÃ­ prvek strÃ¡nky
  * vstupnÃ­ bod do celÃ© aplikace Palpatius

### 1.6 ÃšvodnÃ­ text
* `<section class="intro-text">`
* **Obsah:**
  * vysvÄ›tlenÃ­ filozofie systÃ©mu
  * offline-first pÅ™Ã­stup
  * bezpeÄnost dat (lokÃ¡lnÃ­ uloÅ¾enÃ­)
* Pouze informativnÃ­, bez interakce

### 1.7 AktuÃ¡lnÃ­ Äas
* `<p id="current-time" class="time"></p>`
* Dynamicky doplÅˆovÃ¡n JavaScriptem
* SlouÅ¾Ã­ jako:
  * jemnÃ½ â€Å¾ivÃ½â€œ prvek
  * potvrzenÃ­ bÄ›hu aplikace

## ÄŒÃST 2: `script.js` â€“ Logika zobrazenÃ­ Äasu

### 2.1 FormÃ¡tovÃ¡nÃ­ data
* Funkce: `formatCzechDateTime(date)`
* **PouÅ¾Ã­vÃ¡:**
  * `toLocaleDateString('cs-CZ')`
  * `toLocaleTimeString('cs-CZ', { hour12: false })`
* VÃ½stup:
  * ÄeskÃ½ slovnÃ­ formÃ¡t data
  * 24hodinovÃ½ Äas
  * spojeno znakem â€â€“â€œ

### 2.2 Aktualizace Äasu
* Funkce: `updateTime()`
* ChovÃ¡nÃ­:
  * vyhledÃ¡ `#current-time`
  * pokud neexistuje â†’ bezpeÄnÃ½ nÃ¡vrat
  * jinak aktualizuje text

### 2.3 SpuÅ¡tÄ›nÃ­
* OkamÅ¾itÃ© zavolÃ¡nÃ­ `updateTime()`
* PeriodickÃ¡ aktualizace:
  * `setInterval(updateTime, 1000)`
* **Charakter:**
  * Å¾Ã¡dnÃ© globÃ¡lnÃ­ zÃ¡vislosti
  * Å¾Ã¡dnÃ½ stav
  * ÄistÄ› prezentaÄnÃ­ logika

## ÄŒÃST 3: `style.css` â€“ VizuÃ¡lnÃ­ a A11y vrstva

### 3.1 CelkovÃ½ styl
* MinimalistickÃ½ tmavÃ½ design
* ZamÄ›Å™eno na:
  * klid
  * Äitelnost
  * prvnÃ­ dojem
* Font:
  * `Inter` (konzistentnÃ­ s celÃ½m Palpatiem)

### 3.2 RozvrÅ¾enÃ­ strÃ¡nky
* `body`:
  * flexbox
  * centrovÃ¡nÃ­ horizontÃ¡lnÄ› i vertikÃ¡lnÄ›
  * `min-height: 100vh`
* Text zarovnÃ¡n na stÅ™ed

### 3.3 Typografie
* `.title`
  * velmi vÃ½raznÃ½ (4rem / 900)
  * Å¾lutÃ¡ Palpatius barva `#facc15`
  * jemnÃ½ glow efekt
* `.subtitle`
  * menÅ¡Ã­, klidnÄ›jÅ¡Ã­
* `.intro-text p`
  * ÄitelnÃ½, delÅ¡Ã­ text
  * vyÅ¡Å¡Ã­ line-height

### 3.4 HlavnÃ­ akÄnÃ­ tlaÄÃ­tko
* `.enter-button`
* Vlastnosti:
  * velkÃ©
  * kontrastnÃ­
  * jasnÃ½ hover a focus stav
* **A11y:**
  * vÃ½raznÃ½ focus ring
  * bez JS zÃ¡vislosti

### 3.5 ZobrazenÃ­ Äasu
* `.time`
* UmÃ­stÄ›no dole
* NiÅ¾Å¡Ã­ vizuÃ¡lnÃ­ priorita
* SlouÅ¾Ã­ jako doplnÄ›k, ne ruÅ¡ivÃ½ prvek

### 3.6 Responsivita
* Breakpoint: `640px`
* ZmenÅ¡enÃ­:
  * nÃ¡zvu
  * tlaÄÃ­tka
  * textÅ¯
* ZachovÃ¡na hierarchie a Äitelnost

CelkovÃ½ souhrn:
Palpatius je uzavÅ™enÃ½, offline pracovnÃ­ systÃ©m navrÅ¾enÃ½ pro klidnou a soustÅ™edÄ›nou prÃ¡ci. NestojÃ­ na automatizaci, cloudu ani â€chytrÃ½châ€œ rozhodnutÃ­ch, ale na vÄ›domÃ© kontrole, jednoduchosti a dlouhodobÃ© stabilitÄ›. KaÅ¾dÃ½ modul je samostatnÃ½, ÄitelnÃ½ a bezpeÄnÃ½ sÃ¡m o sobÄ›. Data jsou lokÃ¡lnÃ­, exporty jsou vÄ›domÃ© a struktura systÃ©mu je navrÅ¾ena tak, aby se dala pochopit i po letech. PÅ™Ã­stupnost nenÃ­ vrstva navÃ­c, ale zÃ¡kladnÃ­ architektonickÃ½ princip. Palpatius nenÃ­ experiment ani MVP â€“ je to hotovÃ½ pracovnÃ­ nÃ¡stroj, kterÃ½ pÅ™esnÄ› vÃ­, ÄÃ­m je, a ÄÃ­m nikdy nebude.